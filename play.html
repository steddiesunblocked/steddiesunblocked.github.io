<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EduLink One</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/favicon.ico">

  <!-- Ruffle for SWF -->
  <script src="https://unpkg.com/@ruffle-rs/ruffle"></script>

  <!-- Core site UI (panic banner + Ctrl+E) -->
  <link rel="stylesheet" href="/core.css">

  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #0b0b16;
      overflow: hidden;
      font-family: Arial, Helvetica, sans-serif;
      color: white;
    }

    /* TOP BAR */
    #topbar {
      height: 48px;
      background: linear-gradient(90deg, #6a00ff, #8f3dff);
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 0 14px;
      font-weight: bold;
      z-index: 2;
    }

    #topbar button {
      background: white;
      color: #6a00ff;
      border: none;
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    #title {
      flex: 1;
      text-align: center;
    }

    /* GAME AREA */
    #gameArea {
      height: calc(100% - 48px);
      display: flex;
      justify-content: center;
      align-items: center;
      background: black;
    }

    #gameContainer {
      width: 960px;
      height: 540px;
      background: black;
      border: 4px solid #222;
    }

    iframe, ruffle-player {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* RESPONSIVE */
    @media (max-width: 1000px) {
      #gameContainer {
        width: 100%;
        height: 100%;
        border: none;
      }
    }
  </style>
</head>

<body>

<!-- TOP BAR -->
<div id="topbar">
  <button onclick="history.back()">← Games</button>
  <div id="title">Loading…</div>
  <button onclick="goFullscreen()">⛶</button>
</div>

<!-- GAME -->
<div id="gameArea">
  <div id="gameContainer"></div>
</div>

<script>
  const games = {
    "2048": {
      type: "html5",
      src: "/games/2048/index.html"
    },
    "archery-world-tour": {
      type: "html5",
      src: "/games/archery-world-tour/index.html"
    },
    "4-colours": {
      type: "html5",
      src: "/games/4-colours/index.html"
    }
    // later: swf games here
  };

  const params = new URLSearchParams(location.search);
  const gameKey = params.get("game");
  const game = games[gameKey];
  const container = document.getElementById("gameContainer");

  if (!game) {
    document.getElementById("title").textContent = "Game not found";
  } else {
    document.getElementById("title").textContent =
      gameKey.replace(/-/g, " ");

    if (game.type === "html5") {
      const iframe = document.createElement("iframe");
      iframe.src = game.src;
      iframe.allowFullscreen = true;
      container.appendChild(iframe);
    }

    if (game.type === "swf") {
      const ruffle = document.createElement("ruffle-player");
      ruffle.setAttribute("src", game.src);
      container.appendChild(ruffle);
    }
  }

  function goFullscreen() {
    const el = document.getElementById("gameContainer");
    if (el.requestFullscreen) el.requestFullscreen();
  }
</script>

<!-- CORE PANIC SYSTEM -->
<script src="/core.js"></script>
</body>
</html>
